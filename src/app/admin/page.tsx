'use client';import {useEffect,useState} from 'react';const KEY=process.env.NEXT_PUBLIC_ADMIN_KEY||'devonly';type Lead={when:string;name:string;email:string;utm:string;score:number;ip:string};export default function AdminPage(){const[ok,setOk]=useState(false);const[v,setV]=useState('');const[data,setData]=useState<Lead[]>([]);useEffect(()=>{if(typeof window!=='undefined'&&localStorage.getItem('ADMIN_OK')==='1')setOk(true);},[]);useEffect(()=>{if(!ok)return;fetch('/api/leads').then(r=>r.json()).then(j=>setData(j.items||[])).catch(()=>setData([]));},[ok]);if(!ok){return(<main style={{padding:'24px',fontFamily:'system-ui',maxWidth:520,margin:'40px auto'}}><h1 style={{fontSize:22,fontWeight:600,marginBottom:12}}>Admin</h1><input type="password" placeholder="Pass" value={v} onChange={e=>setV(e.target.value)} style={{width:'100%',padding:'10px',border:'1px solid #ddd',borderRadius:8,marginBottom:12}}/><button onClick={()=>{if(v===KEY){localStorage.setItem('ADMIN_OK','1');setOk(true);}else alert('Wrong pass');}} style={{width:'100%',padding:'10px',borderRadius:12,border:'1px solid #ddd'}}>Entrar</button><p style={{opacity:.6,fontSize:12,marginTop:8}}>Gate temporário • NEXT_PUBLIC_ADMIN_KEY.</p></main>);}return(<main style={{padding:'24px',fontFamily:'system-ui'}}><h1 style={{fontSize:22,fontWeight:600}}>Leads</h1><p style={{opacity:.7,margin:'6px 0 12px'}}>Total: {data.length}</p><div style={{overflow:'auto',border:'1px solid #eee',borderRadius:12}}><table style={{width:'100%',fontSize:13,borderCollapse:'collapse'}}><thead><tr style={{background:'#fafafa'}}><th style="padding:8px 10px;text-align:left">Data/Hora</th><th style="padding:8px 10px;text-align:left">Nome</th><th style="padding:8px 10px;text-align:left">Email</th><th style="padding:8px 10px;text-align:left">UTM</th><th style="padding:8px 10px;text-align:left">Score</th><th style="padding:8px 10px;text-align:left">IP</th></tr></thead><tbody>{data.map((r,i)=>(<tr key={i} style={{borderTop:'1px solid #eee'}}><td style={{padding:'8px 10px',whiteSpace:'nowrap'}}>{r.when}</td><td style={{padding:'8px 10px'}}>{r.name}</td><td style={{padding:'8px 10px'}}>{r.email}</td><td style={{padding:'8px 10px'}}>{r.utm}</td><td style={{padding:'8px 10px'}}>{r.score}</td><td style={{padding:'8px 10px'}}>{r.ip}</td></tr>))}{data.length===0&&(<tr><td colSpan={6} style={{padding:'10px',opacity:.6}}>Sem dados (placeholder).</td></tr>)}</tbody></table></div><button onClick={()=>{localStorage.removeItem('ADMIN_OK');location.reload();}} style={{marginTop:12,padding:'8px 12px',borderRadius:10,border:'1px solid #ddd'}}>Sair</button></main>);}
